{% load extra_filters %}
<div class="product-card group">
    <!-- product header -->
    <div class="product-card_header">
        <div class="flex items-center gap-x-2">
            <div class="tooltip">
                <button class="rounded-full p-1.5 app-border app-hover">
                    <svg class="size-4">
                        <use href="#shopping-cart"></use>
                    </svg>
                </button>
                <div class="tooltiptext">
                    سبد خرید
                </div>
            </div>
            <div class="tooltip">
                <button class="rounded-full p-1.5 app-border app-hover">
                    <svg class="size-4">
                        <use href="#heart"></use>
                    </svg>
                </button>
                <div class="tooltiptext">
                    علاقه مندی
                </div>
            </div>
        </div>
        {% if product.discount_rate %}
            <span class="product-card_badge">{{ product.discount_rate }}% تخفیف‌</span>
        {% endif %}
    </div>
    <!-- product img -->
    <a href="#">
        <img class="product-card_img group-hover:opacity-0 absolute"
             src="{{ product.image.url }}"
             alt="{{ product.title }}">
        {% if product.first_gallery %}
            <img class="product-card_img opacity-0 group-hover:opacity-100"
                 src="{% if product.first_gallery %}{{ product.first_gallery.image.url }}{% endif %}"
                 alt="{{ product.title }}">
        {% else %}
            <img class="product-card_img group-hover:opacity-0 absolute"
                 src="{{ product.image.url }}"
                 alt="{{ product.title }}">
        {% endif %}
    </a>
    <!--  product footer -->
    <div class="space-y-2">
        <a href="#" class="product-card_link">{{ product.title }}</a>
        <!-- Rate and Price -->
        <div class="product-card_price-wrapper">
            <!-- Price -->
            <div class="product-card_price">
                {% if product.discount_rate %}
                    <del>{{ product.price|three_digits }} <h6>تومان</h6></del>
                    <p>{{ product.final_price|three_digits }}</p>
                    <span>تومان</span>
                {% else %}
                    <p>{{ product.price|three_digits }}</p>
                    <span>تومان</span>
                {% endif %}
            </div>
        </div>
    </div>
</div>
